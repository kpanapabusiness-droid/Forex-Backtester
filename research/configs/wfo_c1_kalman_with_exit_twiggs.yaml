# Walk-Forward Optimization (WFO) Configuration for C1: kalman_filter + Exit: exit_twiggs_money_flow
# ---------------------------------------------------------------------
# WFO config for kalman_filter C1 with exit_twiggs_money_flow exit indicator
# Based on wfo_c1_kalman_filter.yaml with exit indicator enabled
#
# Usage:
#   python scripts/walk_forward.py -c configs/wfo_c1_kalman_with_exit_twiggs.yaml
#
# Results will be written to: results/wfo_c1_kalman_with_exit_twiggs/

pairs:
  - AUD_USD
  - EUR_USD
  - GBP_USD
  - USD_CHF

timeframe: "D"

data:
  dir: "data/daily"
  start: "2018-01-01"  # Overall window start (used by WFO to generate folds)
  end: "2022-12-31"    # Overall window end (used by WFO to generate folds)

date_range:
  start: "2018-01-01"  # Also set for backtester compatibility
  end: "2022-12-31"    # Also set for backtester compatibility

indicators:
  c1: "c1_kalman_filter"
  use_c2: false
  use_baseline: false
  use_volume: false
  use_exit: true
  exit: "exit_twiggs_money_flow"

rules:
  one_candle_rule: false
  pullback_rule: false
  bridge_too_far_days: 7
  allow_baseline_as_catalyst: false

entry:
  atr_multiple: 2.0

exit:
  use_trailing_stop: true
  move_to_breakeven_after_atr: true
  exit_on_c1_reversal: true
  exit_on_baseline_cross: false
  exit_on_exit_signal: true

spreads:
  enabled: false
  default_pips: 1.0

tracking:
  in_sim_equity: true
  track_win_loss_scratch: true
  track_roi: true
  track_drawdown: true

risk_filters:
  dbcvix:
    enabled: false
    mode: "reduce"
    threshold: 0.0
    reduce_risk_to: 0.01
    source: "synthetic"

risk:
  starting_balance: 10000.0
  per_trade_pct: 2.0
  risk_per_trade: 0.02
  account_ccy: "USD"

cache:
  enabled: true
  dir: "cache"
  format: "parquet"

walk_forward:
  enabled: true
  run_name: "wfo_c1_kalman_with_exit_twiggs"
  train_years: 2      # Training window: 2 years (24 months)
  test_months: 6      # Out-of-sample test window: 6 months
  step_months: 6      # Rolling step: 6 months

# Default parameter (smoothing: 0.2)
# Parameter range for optimization: [0.15, 0.2, 0.25]
indicator_params:
  c1_kalman_filter:
    smoothing: 0.2


